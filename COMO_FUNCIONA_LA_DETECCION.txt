================================================================================
    ¬øC√ìMO FUNCIONA LA DETECCI√ìN DE INTRUSIONES?
================================================================================

Este documento explica c√≥mo el sistema determina si hay un intruso o ataque
y cu√°ndo lanza una alerta.

================================================================================
1. PROCESO GENERAL
================================================================================

El sistema NO analiza paquetes individuales, sino FLUJOS de red.

Un FLUJO es una conversaci√≥n completa entre dos IPs (origen y destino)
que puede durar segundos o minutos y contener muchos paquetes.

Proceso:
  1. Captura paquetes de red en tiempo real
  2. Agrupa paquetes en flujos (misma IP origen ‚Üî IP destino)
  3. Extrae 78 caracter√≠sticas estad√≠sticas de cada flujo
  4. El modelo ML analiza estas caracter√≠sticas
  5. Predice si el flujo es BENIGNO o un tipo de ATAQUE
  6. Si es ataque ‚Üí LANZA ALERTA

================================================================================
2. ¬øQU√â CARACTER√çSTICAS ANALIZA EL SISTEMA?
================================================================================

El sistema extrae 78 caracter√≠sticas de cada flujo, incluyendo:

A) CARACTER√çSTICAS B√ÅSICAS:
   - Puerto destino
   - Duraci√≥n del flujo
   - N√∫mero total de paquetes (forward y backward)
   - Tama√±o total de datos (forward y backward)

B) ESTAD√çSTICAS DE TAMA√ëOS DE PAQUETES:
   - Tama√±o m√°ximo, m√≠nimo, promedio y desviaci√≥n est√°ndar
   - Tanto para paquetes forward (origen‚Üídestino)
   - Como para paquetes backward (destino‚Üíorigen)

C) ESTAD√çSTICAS DE TIEMPO (IAT - Inter-Arrival Time):
   - Tiempo entre paquetes (media, std, m√°x, m√≠n)
   - Tanto para forward como backward
   - Velocidad de bytes/segundo y paquetes/segundo

D) FLAGS TCP:
   - Conteo de flags FIN, SYN, RST, PSH, ACK, URG
   - En ambas direcciones

E) TAMA√ëOS DE HEADER:
   - Longitud de headers forward y backward
   - Tama√±o de ventana TCP inicial

F) RATIOS Y PROPORCIONES:
   - Ratio Down/Up (descarga/subida)
   - Tama√±o promedio de paquetes
   - Tama√±o promedio de segmentos

G) SUBFLUJOS:
   - Estad√≠sticas de subflujos dentro del flujo principal

H) TIEMPOS ACTIVOS E INACTIVOS:
   - Estad√≠sticas de per√≠odos activos e inactivos

================================================================================
3. ¬øC√ìMO DECIDE EL MODELO ML?
================================================================================

El modelo usa ALGORITMO RANDOM FOREST (Bosque Aleatorio):

A) ENTRENAMIENTO:
   - Se entrena con el dataset CICIDS2017
   - Aprende patrones de:
     * Tr√°fico BENIGNO (normal)
     * Ataques WEB (Brute Force, XSS, SQL Injection)
     * DDoS, Port Scan, Infiltration, etc.

B) PREDICCI√ìN:
   - Cuando recibe las 78 caracter√≠sticas de un flujo:
     1. Compara con patrones aprendidos
     2. Calcula probabilidad para cada clase (BENIGN, Web Attack, etc.)
     3. Selecciona la clase con mayor probabilidad
     4. Retorna: tipo_predicci√≥n + probabilidad

C) DECISI√ìN DE ALERTA:
   - Si predicci√≥n != "BENIGN" ‚Üí ES ATAQUE ‚Üí ALERTA
   - Si predicci√≥n == "BENIGN" ‚Üí ES NORMAL ‚Üí NO ALERTA

================================================================================
4. ¬øCU√ÅNDO SE LANZA UNA ALERTA?
================================================================================

Condiciones para que se lance una alerta:

1. ‚úÖ El modelo ML debe estar entrenado y cargado
2. ‚úÖ El flujo debe tener al menos 5 paquetes capturados
   (Para tener suficientes datos para calcular caracter√≠sticas)
3. ‚úÖ El modelo predice que NO es "BENIGN"
4. ‚úÖ La probabilidad de la predicci√≥n es suficiente
   (El modelo siempre retorna la clase con mayor probabilidad)

Ejemplo:
   - Flujo con 5+ paquetes
   - Caracter√≠sticas extra√≠das
   - Modelo predice: "Web Attack - Brute Force" con 85% probabilidad
   - Como NO es "BENIGN" ‚Üí üö® ALERTA LANZADA

================================================================================
5. TIPOS DE ATAQUES QUE PUEDE DETECTAR
================================================================================

Depende del dataset usado para entrenar:

Con "Thursday-WorkingHours-Morning-WebAttacks.pcap_ISCX.csv":
   - ‚úÖ Web Attack - Brute Force
   - ‚úÖ Web Attack - XSS (Cross-Site Scripting)
   - ‚úÖ Web Attack - SQL Injection
   - ‚úÖ BENIGN (tr√°fico normal)

Con otros datasets del CICIDS2017:
   - DDoS (Distributed Denial of Service)
   - Port Scan
   - Infiltration
   - Botnet
   - Y m√°s...

IMPORTANTE: El modelo solo detecta tipos de ataques que vio durante
el entrenamiento. Si entrenas solo con Web Attacks, NO detectar√° DDoS.

================================================================================
6. ¬øQU√â HACE QUE ALGO SEA DETECTADO COMO ATAQUE?
================================================================================

El modelo busca PATRONES AN√ìMALOS en las caracter√≠sticas:

Ejemplos de patrones que indican ataques:

A) WEB ATTACK - BRUTE FORCE:
   - Muchos paquetes peque√±os en poco tiempo
   - M√∫ltiples intentos de conexi√≥n (muchos SYN)
   - Ratio alto de paquetes/segundo
   - Headers peque√±os pero muchos paquetes

B) WEB ATTACK - SQL INJECTION:
   - Paquetes con tama√±os inusuales
   - Patrones en los tiempos entre paquetes
   - Headers m√°s largos de lo normal
   - Comportamiento asim√©trico (mucho forward, poco backward)

C) DDoS:
   - Enorme cantidad de paquetes
   - M√∫ltiples flujos desde diferentes IPs
   - Tasa muy alta de bytes/segundo
   - Patrones de sincronizaci√≥n

D) PORT SCAN:
   - Muchos flujos cortos
   - M√∫ltiples puertos destino
   - Muchos SYN sin completar conexi√≥n
   - Flujos de muy corta duraci√≥n

================================================================================
7. LIMITACIONES Y CONSIDERACIONES
================================================================================

A) DEPENDE DEL ENTRENAMIENTO:
   - Solo detecta lo que aprendi√≥
   - Si el tr√°fico es muy diferente al dataset, puede fallar

B) FALSOS POSITIVOS:
   - Tr√°fico leg√≠timo puede parecer sospechoso
   - Ejemplo: descarga grande de archivo ‚Üí puede parecer DDoS

C) FALSOS NEGATIVOS:
   - Ataques nuevos o muy sofisticados pueden pasar desapercibidos
   - Ataques que no est√°n en el dataset de entrenamiento

D) REQUIERE SUFICIENTES DATOS:
   - Necesita al menos 5 paquetes por flujo
   - Flujos muy cortos pueden no detectarse

E) EXTRACCI√ìN SIMPLIFICADA:
   - Algunas caracter√≠sticas del dataset original requieren
     an√°lisis m√°s profundo que se simplifican en tiempo real
   - Esto puede afectar la precisi√≥n

================================================================================
8. EJEMPLO PR√ÅCTICO
================================================================================

Escenario: Alguien intenta hacer Brute Force a un servidor web

1. CAPTURA:
   - Se capturan paquetes TCP hacia el puerto 80 (HTTP)
   - IP atacante ‚Üí IP servidor

2. AGRUPACI√ìN:
   - Se agrupan en un flujo: 192.168.1.100:54321 ‚Üî 192.168.1.1:80

3. EXTRACCI√ìN (despu√©s de 5 paquetes):
   - Total Fwd Packets: 50
   - Total Backward Packets: 2
   - Flow Duration: 2.5 segundos
   - Flow Packets/s: 20.8
   - Fwd Packet Length Mean: 120 bytes
   - SYN Flag Count: 50
   - ... (y 72 caracter√≠sticas m√°s)

4. PREDICCI√ìN:
   - Modelo analiza las 78 caracter√≠sticas
   - Compara con patrones aprendidos
   - Predice: "Web Attack - Brute Force" (probabilidad: 87%)

5. ALERTA:
   - Como NO es "BENIGN" ‚Üí üö® ALERTA
   - Se guarda en alertas.json
   - Se muestra en la interfaz web
   - Se imprime en consola: "üö® ALERTA: Web Attack - Brute Force (87.0%)"

================================================================================
9. RESUMEN
================================================================================

¬øHAY INTRUSO?
   ‚Üí El modelo ML analiza 78 caracter√≠sticas del flujo
   ‚Üí Compara con patrones aprendidos del dataset
   ‚Üí Si predice algo diferente a "BENIGN" ‚Üí S√ç, hay intruso

¬øCU√ÅNDO LANZA ALERTA?
   ‚Üí Cuando el flujo tiene 5+ paquetes
   ‚Üí Y el modelo predice un tipo de ataque (no BENIGN)
   ‚Üí Con una probabilidad suficiente

¬øDE QU√â DEPENDE?
   ‚Üí Del modelo entrenado (qu√© tipos de ataques conoce)
   ‚Üí De las caracter√≠sticas extra√≠das del flujo
   ‚Üí De los patrones aprendidos durante el entrenamiento

================================================================================
10. MEJORAR LA DETECCI√ìN
================================================================================

Para mejorar la detecci√≥n:

1. Entrenar con m√∫ltiples datasets del CICIDS2017
2. Ajustar hiperpar√°metros del Random Forest
3. Usar modelos m√°s avanzados (Neural Networks, etc.)
4. Mejorar la extracci√≥n de caracter√≠sticas
5. Agregar an√°lisis de contenido (no solo estad√≠sticas)
6. Implementar detecci√≥n de anomal√≠as adem√°s de clasificaci√≥n

================================================================================

